/*!
 * Deep-link.js
 * https://timseverien.com/projects/deep-link/
 *
 * Copyright 2016
 * Released under MIT license
 */
!function(e,t){"function"==typeof define&&define.amd?define([],t):e.deepLink=t()}(this,function(){"use strict";function e(){for(var e=document.getElementsByTagName("a"),t=e.length;t--;)s(e[t])}var t=1200,n={windows:{store_prefix:"zune:navigate?appid=",test:/Windows\s+Phone|IEMobile/i},android:{store_prefix:"https://play.google.com/store/apps/details?id=",test:/Android/i},iOS:{store_prefix:"https://itunes.apple.com/en/app/id",test:/iPhone|iPad|iPod/i}},i=function(){var e;for(e in n)if(navigator.userAgent.match(n[e].test))return e;return""},r=function(){return(new Date).getTime()},a=function(e){window.location.href=e},o=function(e,t,n,i){var r=navigator.userAgent.indexOf("Android")>-1&&navigator.userAgent.indexOf("Mozilla/5.0")>-1&&navigator.userAgent.indexOf("AppleWebKit")>-1,a=new RegExp(/AppleWebKit\/([\d.]+)/),o=a.exec(navigator.userAgent),s=null===o?null:parseFloat(a.exec(navigator.userAgent)[1]),u=r&&null!==s&&s>500;return u?"intent:"+e.split(":")[1]+"#Intent;scheme="+i+";package="+t+";S.browser_fallback_url="+encodeURI(n):e},s=function(e){var s,u,d=i(),p=d.toLowerCase(),f=e.getAttribute("href"),l=e.getAttribute("data-app-"+p)||e.getAttribute("data-app"),c=e.getAttribute("data-store-"+p)||e.getAttribute("data-store"),g=e.getAttribute("data-android-scheme");l&&(f||e.setAttribute("href",l),d&&l?e.onclick=function(e){e.preventDefault(),e.stopImmediatePropagation();var i,p=r();s=!0,u=setTimeout(function(){if(s&&u){var e=r();s=!1,u=null,e-p>=2*t||(c?a(n[d].store_prefix+c):f&&a(f))}},t);var v=o(l,c,f,g);i=a(v)}:f&&"#"!==f||(e.style.display="none"),visibly.onHidden(function(){s&&u&&(u=clearInterval(u),s=!1)}))};return{init:e}});